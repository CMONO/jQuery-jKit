
// jQuery Plugin: jKit
// A very easy to use, cross platform jQuery UI toolkit that's still small in size, has the features you need and doesn't get in your way.
// Version 1.2.11 - 7. May. 2013
// http://jquery-jkit.com/
//
// by Fredi Bach
// http://fredibach.ch/jquery-plugins/

(function($,undefined){$.jKit=function(element,options,moreoptions){var defaults={prefix:"jkit",dataAttribute:"data-jkit",activeClass:"active",errorClass:"error",successClass:"success",ignoreFocus:!1,ignoreViewport:!1,keyNavigation:!0,touchNavigation:!0,plugins:{},replacements:{},delimiter:",",loadminified:!0,macros:{"hide-if-empty":"binding:selector=this;source=text;mode=css.display","smooth-blink":"loop:speed1=2000;duration1=250;speed2=250;duration2=2000"},commands:{}},plugin=this;plugin.version="1.2.11",plugin.inc=[],plugin.settings={},plugin.commands={},plugin.executions={};var $element=$(element),element=element;if("string"==typeof options){var singlecommand=options;moreoptions==undefined&&(moreoptions={}),options=moreoptions}var startX,startY,windowhasfocus=!0,uid=0,commandkeys={};($.support.htmlSerialize||$.support.opacity)&&$(window).focus(function(){windowhasfocus=!0}).blur(function(){windowhasfocus=!1}),plugin.init=function(a){a==undefined&&(a=$element),plugin.settings=$.extend({},defaults,options);var b=plugin.settings;singlecommand!=undefined?plugin.executeCommand(a,singlecommand,options):a.find("*[rel^=jKit], *["+b.dataAttribute+"]").each(function(){var c=this,d=$(this).attr("rel"),e=$(this).attr(b.dataAttribute);d=e!=undefined?$.trim(e).substring(1):$.trim(d).substring(5),d=d.substring(0,d.length-1),d=d.replace(/\]\s+\[/g,"]["),relsplit=d.split("]["),$.each(relsplit,function(d,e){e=e.replace(/\\=/g,"|jkit-eq|").replace(/\\:/g,"|jkit-dp|").replace(/\\;/g,"|jkit-sc|").replace(/\\\[/g,"|jkit-sbo|").replace(/\\\]/g,"|jkit-sbc|").replace(/\\\*/g,"|jkit-st|").replace(/\\ /g,"|jkit-sp|"),e=$.trim(e),b.macros[e]!=undefined&&(e=b.macros[e]);var f=plugin.parseOptions(e);if(b.macros[f.type]!=undefined){var g=plugin.parseOptions(b.macros[f.type]);f.type=g.type,f=$.extend({},g,f)}if("macro"==f.type&&relsplit[d-1]!=undefined)plugin.settings.macros[f.name]=relsplit[d-1];else if("repeat"==f.type&&relsplit[d-1]!=undefined){var h=plugin.parseOptions(relsplit[d-1]);a.on(f.onevent,function(){f.delay==undefined&&(f.delay=0),setTimeout(function(){plugin.executeCommand($(c),h.type,h)},f.delay)})}else if("info"==f.type){var i="jKit version: "+plugin.version+"\n";i+="Included commands: "+plugin.inc.join(", ")+"\n",console.log(i),console.log(a)}else{var j=[];if(f.target!=undefined){var k=f.target.split(".");switch(k=[k.shift(),k.join(".")],k[1]==undefined&&(k[1]="*"),k[0]){case"children":$(c).children(k[1]).each(function(){j.push(this)});break;case"each":$(c).find(k[1]).each(function(){j.push(this)});break;default:j.push(c)}}else j.push(c);$.each(j,function(e,g){var h=plugin.parseDynamicOptions(f);if(h.commandkey==undefined){var i=$(c).attr("id");h.commandkey=i!=undefined?i:b.prefix+"-uid-"+ ++uid}if(h.commandkey!=undefined&&(commandkeys[h.commandkey]={el:g,options:h,execs:0}),h.onevent!==undefined||h.andonevent!==undefined){var j=[];h.onevent!==undefined&&j.push(h.onevent),h.andonevent!==undefined&&j.push(h.andonevent);var k=j.join(" ");a.on(k,function(){b.replacements[h.type]!=undefined&&"function"==typeof b.replacements[h.type]?b.replacements[h.type].call(plugin,g,h.type,h):plugin.executeCommand(g,h.type,h)})}if(h.onevent===undefined)if(relsplit[d-1]!=undefined){var l="";if(relsplit[d-1]!=undefined){var m=plugin.parseOptions(relsplit[d-1]);l=m.type+"."+h.commandkey+".executed"}""!=l&&plugin.executions[m.type+"."+h.commandkey+".executed"]===undefined?a.on(l,function(){b.replacements[h.type]!=undefined&&"function"==typeof b.replacements[h.type]?b.replacements[h.type].call(plugin,g,h.type,h):plugin.executeCommand(g,h.type,h)}):b.replacements[h.type]!=undefined&&"function"==typeof b.replacements[h.type]?b.replacements[h.type].call(plugin,g,h.type,h):plugin.executeCommand(g,h.type,h)}else b.replacements[h.type]!=undefined&&"function"==typeof b.replacements[h.type]?b.replacements[h.type].call(plugin,g,h.type,h):plugin.executeCommand(g,h.type,h)})}})})},plugin.applyMacro=function(a,b){var c=plugin.settings;if(c.macros[b]!=undefined){var d=c.macros[b],e=plugin.parseOptions(d);c.replacements[e.type]!=undefined&&"function"==typeof c.replacements[e.type]?c.replacements[e.type].call(plugin,a,e.type,e):plugin.executeCommand(a,e.type,e)}},plugin.parseOptions=function(a){var b=a.split(":"),c=b[0].split("."),d={type:$.trim(c[0])};if(c[1]!==undefined&&(d.commandkey=c[1]),d.execute==undefined&&(d.execute="always"),b.length>1){var e=b[1].split(";");$.each(e,function(a,b){var c=b.split("=");d[$.trim(c[0])]=$.trim(c[1])})}return d},plugin.fixSpeed=function(a){return"fast"!=a&&"slow"!=a&&(a=parseInt(a)),a},plugin.parseDynamicOptions=function(a){var b={};for(index in a){var c=a[index];if(c!==undefined&&c.indexOf("{")>-1&&c.indexOf("|")>0&&c.indexOf("}")>1){for(var d="",e=!1,f="",g=!1,h=0;c.length-1>=h;h++)if(e||"{"!=c.charAt(h)?e&&"}"==c.charAt(h)&&(e=!1,g=!0):e=!0,e||g){if(f+=c.charAt(h),g){f=f.slice(1,-1);var i=f.split("|");if("rand"==i[0]){var j=i[1].split("-");d+=plugin.getRandom(Number(j[0]),Number(j[1]))}g=!1,f=""}}else d+=c.charAt(h);b[index]=d}else b[index]=c}return b},plugin.getRandom=function(a,b){if(a>b)return-1;if(a==b)return a;var c;do c=Math.random();while(1==c);return a+parseInt(c*(b-a+1))},plugin.findElementTag=function(a,b,c,d){var e="";if(c===undefined||isNaN(c)||parseInt(c)!=c){var f={};a.find(b).each(function(a){if(!(25>a))return!1;var b=$(this).prop("tagName");""!=b[0]&&(f[b]!==undefined?f[b]++:f[b]=1)});var g=0,h="";for(var i in f)f[i]>g&&(g=f[i],h=i);e=h}else a.find(b).length>c&&(e=$(a.find(b).get(c)).prop("tagName"));return e!==undefined&&""!=e?e:d},plugin.addDefaults=function(a,b){if(plugin.settings.commands[a]!=undefined){var c=plugin.settings.commands[a];$.each(c,function(a,c){b[a]==undefined&&(b[a]=c),a.indexOf("speed")>-1&&(b[a]=plugin.fixSpeed(b[a]))})}return b},plugin.executeCommand=function(that,type,options){var s=plugin.settings,$that=$(that);if(plugin.commands[type]===undefined&&(plugin.commands[type]=[]),$.isArray(plugin.commands[type])){if(plugin.commands[type].push({el:that,options:options}),s.loadminified)var commandurl="jquery.jkit.commands/"+type+".min.js";else var commandurl="jquery.jkit.commands/"+type+".js";return 1==plugin.commands[type].length&&$.ajax({url:"jquery.jkit.commands/"+type+".js",success:function(data){if(-1!==data.indexOf("plugin.commands.")){var queue=plugin.commands[type];eval(data),$.each(queue,function(a,b){plugin.executeCommand(b.el,type,b.options)})}},dataType:"text"}),$that}return $element.trigger("jkit-commandinit",{element:$that,type:type,options:options}),options.commandkey!==undefined&&(commandkeys[options.commandkey].execs++,"once"==options.execute&&commandkeys[options.commandkey].execs>1||!isNaN(options.execute)&&commandkeys[options.commandkey].execs>options.execute)?$that:(options=plugin.addDefaults(type,options),$.each(options,function(a,b){"string"==typeof b&&(options[a]=b=b.replace(/\|jkit\-eq\|/g,"=").replace(/\|jkit\-dp\|/g,":").replace(/\|jkit\-sc\|/g,";").replace(/\|jkit\-sbo\|/g,"[").replace(/\|jkit\-sbc\|/g,"]").replace(/\|jkit\-st\|/g,"*").replace(/\|jkit\-sp\|/g," ")),"string"==typeof b&&"*"==b.slice(-1)&&(options[a]=window[b.slice(0,-1)],"function"==typeof options[a]&&(options[a]=options[a].call(that)))}),plugin.commands[type].execute($that,options),"remove"!=type&&($element.trigger(type+"."+options.commandkey+".executed",{}),plugin.executions[type+"."+options.commandkey+".executed"]=!0),$that)},plugin.triggerEvent=function(a,b,c){if(c.commandkey!==undefined){var d=a.split(" ");$.each(d,function(a,d){$element.trigger(c.commandkey+"."+d,{element:b,options:c})})}},plugin.cssFromString=function(a){var b=a.split(","),c={};return $.each(b,function(a,b){var d=b.split("(");if(2==d.length){var e=d[0],f=d[1].slice(0,-1);c[e]=f}}),c},plugin.addCommandDefaults=function(a,b){defaults.commands[a]=b,$element.trigger("command."+a+".loaded",{})},plugin.addKeypressEvents=function(a,b){plugin.settings.keyNavigation&&$(document).keydown(function(c){if(this===c.target||!/textarea|select/i.test(c.target.nodeName)&&"text"!==c.target.type){for(var d={8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},e=48;90>=e;e++)d[e]=String.fromCharCode(e).toLowerCase();if($.inArray(c.which,d)){var f="";c.altKey&&(f+="alt+"),c.ctrlKey&&(f+="ctrl+"),c.metaKey&&(f+="meta+"),c.shiftKey&&(f+="shift+");var g=f+d[c.which];g==b&&(a.trigger(f+d[c.which]),c.preventDefault())}}})},plugin.commands.init=function(){var a={};return plugin.addCommandDefaults("init",{}),a.execute=function(a,b){plugin.init(a),plugin.triggerEvent("complete",a,b)},a}(),plugin.commands.encode=function(){var a={};plugin.addCommandDefaults("encode",{format:"code",fix:"yes"}),a.execute=function(a,c){switch(c.format){case"code":var d=a.html();"yes"==c.fix&&(d=b(d)),a.html(d.replace(/</g,"&lt;").replace(/>/g,"&gt;"));break;case"text":a.html(a.text());break;case"esc":a.html(escape(a.html()));break;case"uri":a.html(encodeURI(a.html()))}};var b=function(a){var b=a.split("\n"),c=9999;return $.each(b,function(a,b){if(""!=$.trim(b)){for(var d=-1;"	"==b.charAt(d+1);)d++;d++,c>d&&(c=d)}}),$.each(b,function(a,d){b[a]=d.substr(c)}),b.join("\n")};return a}(),plugin.commands.chart=function(){var a={};return plugin.addCommandDefaults("chart",{max:0,delaysteps:100,speed:500,easing:"linear"}),a.execute=function(a,b){var c=plugin.settings,d=a.find("thead > tr > th.label").text(),e=a.attr("id"),f=[];a.find("thead > tr > th").each(function(){$(this).hasClass("label")||f.push($(this).text())});var g=0,h=[];a.find("tbody tr").each(function(){var a={label:$(this).find("th.label").text(),data:[]};$(this).find("th").each(function(){if(!$(this).hasClass("label")){var b=Number($(this).text());g=Math.max(b,g),a.data.push(b)}}),h.push(a)}),b.max>0&&b.max>g&&(g=b.max);var i=$("<div/>",{id:e,"class":c.prefix+"-chart"}),j=0,k=0;$.each(f,function(e,l){j++;var m=$("<div/>",{"class":c.prefix+"-chart-step"}).html("<label>"+l+"</label>").appendTo(i);$.each(h,function(a){if(h[a].data[e]>0){var i=$("<div/>",{"class":c.prefix+"-chart-plot "+c.prefix+"-chart-plot"+a}).appendTo(m);$("<div/>").text(h[a].label).delay(k).animate({width:100*(h[a].data[e]/g)+"%"},b.speed,b.easing).appendTo(i),$("<span/>",{"class":c.prefix+"-chart-info"}).text(d+" "+h[a].label+": "+h[a].data[e]+" "+b.units).appendTo(i)}}),j==f.length&&setTimeout(function(){plugin.triggerEvent("complete",a,b)},b.speed+k),k+=Number(b.delaysteps)}),a.replaceWith(i)},a}(),plugin.commands.animation=function(){var a={};plugin.addCommandDefaults("animation",{fps:25,loop:"no",from:"",to:"",speed:"500",easing:"linear",delay:0,on:""}),a.execute=function(a,c){var d=plugin.settings;if(""!=c.to)""!=c.from&&a.css(plugin.cssFromString(c.from)),setTimeout(function(){""!=c.on?a.on(c.on,function(){a.animate(plugin.cssFromString(c.to),c.speed,c.easing,function(){c.macro!=undefined&&plugin.applyMacro(a,c.macro),plugin.triggerEvent("complete",a,c)})}):a.animate(plugin.cssFromString(c.to),c.speed,c.easing,function(){c.macro!=undefined&&plugin.applyMacro($el,c.macro),plugin.triggerEvent("complete",a,c)})},c.delay);else{c.interval=1e3/c.fps;var e=[],f=0,g=0;a.children().each(function(){var a=$(this).attr("rel"),b=$(this).attr(d.dataAttribute);if(b!=undefined)var c=b.indexOf("["),h=b.indexOf("]"),i=b.substring(c+1,h);else var c=a.indexOf("["),h=a.indexOf("]"),i=a.substring(c+1,h);var j=plugin.parseOptions(i);j.el=$(this),j.easing==undefined&&(j.easing="linear"),j.start=f,f+=parseInt(j.steps),j.end=f,g=f,f++,e.push(j)}),c.lastframe=g,a.css("overflow","hidden"),a.html(e[0].el),window.setTimeout(function(){b(e,-1,a,c)},0)}};var b=function(a,c,d,e){if((windowhasfocus||!windowhasfocus&&plugin.settings.ignoreFocus)&&(d.jKit_inViewport()||!d.jKit_inViewport()&&plugin.settings.ignoreViewport)){plugin.triggerEvent("showframe showframe"+(c+1),d,e),$.each(a,function(b,f){if(f.start==c){d.html(f.el.clone());var g=(f.end-f.start)*e.interval;if("fadeout"==f.action)d.children(":first").show().fadeTo(g,0,f.easing);else if("fadein"==f.action)d.children(":first").hide().fadeTo(g,1,f.easing);else if("fadeinout"==f.action)d.children(":first").hide().fadeTo(g/2,1,f.easing).fadeTo(g/2,0,f.easing);else if("tween"==f.action){var h=a[b+1].el;d.children(":first").animate({"font-size":h.css("font-size"),"letter-spacing":h.css("letter-spacing"),color:h.css("color"),opacity:h.css("opacity"),"background-color":h.css("background-color"),"padding-top":h.css("padding-top"),"padding-bottom":h.css("padding-bottom"),"padding-left":h.css("padding-left"),"padding-right":h.css("padding-right")},g,f.easing)}}}),c++;var f=!1;c>e.lastframe&&(c=0,f=!0),(f&&"yes"==e.loop||!f)&&window.setTimeout(function(){b(a,c,d,e)},e.interval),"no"==e.loop&&(e.macro!=undefined&&plugin.applyMacro(d,e.macro),plugin.triggerEvent("complete",d,e))}else window.setTimeout(function(){b(a,c,d,e)},e.interval)};return a}(),plugin.commands.tooltip=function(){var a={};return plugin.addCommandDefaults("tooltip",{text:"",content:"",color:"#fff",background:"#000",classname:"",follow:"no",event:"mouse",yoffset:20}),a.execute=function(a,b){var c=plugin.settings,d=!1;0==$("div#"+c.prefix+"-tooltip").length&&$("<div/>",{id:c.prefix+"-tooltip"}).css("position","absolute").hide().appendTo("body"),$tip=$("div#"+c.prefix+"-tooltip"),""!=b.content?b.text=$(b.content).html():(""==b.text&&(b.text=$.trim(a.attr("title"))),""==b.text&&(b.text=$.trim(a.attr("alt"))));var e="mouseenter",f="mouseleave click";"focus"==b.event&&(e="focus",f="blur"),a.on(e,function(c){""!=b.classname?$tip.html(b.text).removeClass().css({background:"",color:""}).addClass(b.classname):$tip.html(b.text).removeClass().css({background:b.background,color:b.color}),"focus"==b.event?$tip.css({top:a.offset().top+a.outerHeight(),left:a.offset().left}):($tip.css("top",c.pageY+b.yoffset).css("left",c.pageX),parseInt($tip.css("left"))>$(window).width()/2&&$tip.css("left","0px").css("left",c.pageX-$tip.width())),$tip.stop(!0,!0).fadeIn(200),plugin.triggerEvent("open",a,b),d=!0}).on(f,function(){var e=200;$tip.is(":animated")&&(e=0),$tip.stop(!0,!0).fadeOut(e,function(){d=!1}),plugin.triggerEvent("closed",a,b)}),"yes"==b.follow&&$("body").on("mousemove",function(a){d&&$tip.css("top",a.pageY+b.yoffset-$(window).scrollTop()).css("left",a.pageX)})},a}(),plugin.commands.show=function(){var a={};return plugin.addCommandDefaults("show",{delay:0,speed:500,animation:"fade",easing:"linear"}),a.execute=function(a,b){a.hide().jKit_effect(!0,b.animation,b.speed,b.easing,b.delay,function(){plugin.triggerEvent("complete",a,b)})},a}(),plugin.commands.swap=function(){var a={};return plugin.addCommandDefaults("swap",{versions:"_off,_on",attribute:"src"}),a.execute=function(a,b){var c=plugin.settings,d=b.versions.split(c.delimiter),e=!1,f=a.attr(b.attribute),g=a.attr(b.attribute).replace(d[0],d[1]);"src"==b.attribute&&($("<img/>")[0].src=g),a.on("mouseenter click",function(){e||(a.attr(b.attribute,g),plugin.triggerEvent("active",a,b),e=!0)}).on("mouseleave click",function(){e&&(a.attr(b.attribute,f),plugin.triggerEvent("inactive",a,b),e=!1)})},a}(),plugin.commands.limit=function(){var a={};return plugin.addCommandDefaults("limit",{elements:"children",count:5,animation:"none",speed:250,easing:"linear",endstring:"..."}),a.execute=function(a,b){if("children"==b.elements)a.children(":gt("+(b.count-1)+")").each(function(){$(this).jKit_effect(!1,b.animation,b.speed,b.easing)}),setTimeout(function(){plugin.triggerEvent("complete",a,b)},b.speed);else{var c=a.text().substr(0,b.count);c!=a.text()&&(c=c.substr(0,c.length-b.endstring.length)+b.endstring,a.text(c))}},a}(),plugin.commands.lorem=function(){var a={};return plugin.addCommandDefaults("lorem",{paragraphs:0,length:"",random:"no"}),a.execute=function(a,b){var c=["Lorem ipsum dolor sit amet, consectetur adipisici elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut 
